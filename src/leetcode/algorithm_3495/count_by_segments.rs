pub struct Solution;

impl Solution {
    pub fn min_operations(queries: Vec<Vec<i32>>) -> i64 {
        let mut count = 0;
        for q in queries.into_iter() {
            count += (Self::counts(q[0], q[1]) as f64 / 2.0).ceil() as i64
        }
        count
    }

    fn counts(l: i32, r: i32) -> i64 {
        if l > r {
            return 0;
        }
        let rp = (r as f64).log(4.0);
        if rp == rp.floor() {
            return Self::counts(l, r - 1) + (rp + 1.0) as i64;
        }
        let per_count = (rp + 1.0) as i64;
        let sep = l.max(4_i32.pow(rp.floor() as u32));
        Self::counts(l, sep - 1) + (r - sep + 1) as i64 * per_count
    }
}

#[cfg(test)]
mod tests {
    use super::*;
    use crate::vecvec;
    use test_case::test_case;

    #[test_case(vecvec![[1,2],[2,4]] => 3; "example 1")]
    #[test_case(vec![vec![2,6]] => 4; "example 2")]
    #[test_case(vec![vec![1,8]] => 7; "case 1")]
    #[test_case(vecvec![[855407150,876255590],[967587865,990508908],[730921172,766957042],[132328523,582511466],[52528451,342405685],[960740165,993940388],[295357365,972582056],[301584043,674638635],[22333241,50052834],[172608385,644729129],[571351581,610870532],[866228725,927947734],[543159135,986992629],[510683126,726679179],[43863970,292628606],[841928053,874430013],[382358163,977381025],[948485147,956231401],[763761229,860394428],[864623723,907819175],[500062619,703596924],[968526821,972910650],[100363133,120219835],[522564417,768842279],[564533889,591973734],[765788738,872263163],[142775969,343304130],[181676980,353715248],[732864817,753830523],[90085422,561170039],[307576559,341365244],[429369452,814423176],[116848574,302584910],[84013951,349559782],[869342951,959140538],[618780405,917310915],[65140056,89288530],[8189670,960383203],[797285434,799122243],[466408780,951444466],[399523323,586478192],[642777986,739312291],[645894913,989813496],[16449852,527996430],[915215759,960482673],[543610903,610305464],[454633123,754688616],[463674256,694411626],[921003127,987875430],[598996725,710767133],[911383342,995583522],[663444134,948647449],[193227012,442544670],[549711935,674816077],[888223554,951622137],[734340291,808216000],[575329202,968308286],[957378789,972971384],[498194468,561429679],[253122945,438568217],[651998972,856261492],[505963589,596386706],[526285861,665639840],[342354602,453754429],[968435404,973333437],[970061621,975168738],[942210534,960050523],[371009498,501511502],[542212865,994115003],[31901719,934274696],[722890402,986073989],[163140398,744581576],[776418731,817585205],[502643671,602504657],[938458213,988935112],[863517694,868569063],[428436942,981583698],[505275504,901639584],[815062497,932102788],[918535030,961204785],[880229833,899470886],[327272432,528845887],[294730415,646218044],[478640711,614631730],[128737665,343168326],[35274836,811628106],[838547731,854093967],[238626528,548479171],[779660215,846977234],[405804137,763809456],[69455588,297765809],[635789487,868218499],[714659597,825874614],[223451383,498132899],[729703431,864736711],[750959784,752192353],[795147080,872292789],[261755771,449799235],[893130244,990679663],[687626798,731146371],[233211947,610132500],[333277262,781637055],[181317354,339179493],[156695877,578824357],[959187103,984633448],[14612520,312121475],[707242130,718035670],[418788927,421215251],[84442993,109077699],[942668149,995732896],[496023114,975097750],[888892555,905211594],[277185189,335060113],[544761790,666361573],[576650505,627231742],[384358820,984049839],[449022182,881598171],[771302198,873059876],[884280879,933232908],[692565666,970246871],[354404793,668753945],[738852491,804137146],[768055768,959334576],[613918144,661041593],[756661324,854079789],[199909066,786576921],[12158685,991822476],[493085207,827063218],[776416033,900643725],[945091108,966280354],[976669194,995884885],[909946244,945706127],[828985231,979642234],[978857310,996612728],[300412368,373922069],[996788533,997424506],[486164471,982263641],[730636914,777687022],[123468163,444104385],[5830390,923842955],[641346448,998106667],[96775368,249636685],[765457696,793578914],[999212719,999439439],[218011678,441332646],[550921836,797782047],[290455753,363794576],[283725953,320630327],[63735085,698124839],[80749805,637203105],[675272540,761320856],[984899422,995468910],[156338636,606025318],[926728645,955206211],[210741297,278846562],[244047417,288667471],[923111076,939574130],[283897856,742729003],[264059662,354656508],[744903304,971721028],[510747195,715728421],[119486264,933465872],[134348242,404980580],[426582717,918902780],[806654314,965297812],[542577027,640339827],[756981555,996466525],[776948152,930883262],[546635495,919250357],[223837050,675773947],[705378513,932430854],[985568552,989863457],[519193075,929019331],[752954131,835465802],[222880631,769379516],[145298462,378159315],[435239913,755884571],[768379846,849927136],[459642476,511132830],[396822595,957047613],[841353270,859922707],[452969804,650217201],[348483162,437775129],[146910524,430483158],[984465903,990540849],[276236180,287384199],[464858369,736369500],[498979550,822227313],[239003517,626981623],[71424188,800633298],[680590601,830618034],[437558020,753611669],[523141053,957645822],[505741190,511692509],[671243767,956377948],[695495097,984090892],[320463003,954719188],[148441572,382280037],[47796145,535038417],[329201282,708718429],[688307065,757711152],[762624897,936567174],[376901580,563211012],[185987252,876201377],[581155471,697066214],[232783617,877802861],[410402172,627329376],[75693665,133714883],[276334198,686697753],[407456624,690134920],[952730235,988847710],[328617298,431830842],[449370843,968566233],[185220947,430114966],[251068310,627018977],[405900844,922535671],[437485287,855760518],[101532739,564985765],[780359826,799861376],[697380621,938628813],[845830845,968254984],[473354536,635778024],[707393801,931779540],[80131182,712564569],[849963531,859335874],[403573389,894107933],[417667448,469820416],[644449196,687614464],[401278910,801951942],[29587990,878242509],[183345206,495568917],[417551474,580365001],[556861194,879151109],[511435215,672781226],[600176196,832211978],[808417190,813405802],[979922483,994892108],[299599832,889991331],[343664828,861101111],[900504716,910713343],[788791824,876954607],[401178311,981714662],[545833474,947967207],[139481983,789904550],[488063831,518171455],[762822788,985358529],[835673661,983976769],[779724282,939611469],[180718387,326783369],[235434613,288953719],[572659298,940106936],[104160684,375633501],[158916412,863950136],[711619154,731825692],[197858750,842475161],[845933267,938105225],[968006797,970482663],[474775250,925453710],[556980660,754778472],[973094127,974863401],[432488565,731505015],[139565746,762558201],[50760415,834553647],[725262763,806743114],[458265149,784523103],[905755236,975553792],[173392915,321609987],[301389992,384197387],[587849673,787320442],[804320512,947034114],[809996309,988449462],[445935774,453702844],[906624011,997812666],[852789173,988632825],[551704178,583740477],[305083301,917986931],[916170370,946900801],[869252049,941926866],[824873612,991497443],[155181365,405932688],[953959922,990017323],[842308154,949217001],[108063145,228944958],[582615932,838673946],[140945157,685558930],[94319192,807674515],[615792364,817450255],[586834219,893701444],[847979001,914432065],[699917113,798270352],[820177706,940627399],[488785673,671317850],[37102309,649438138],[301260953,728081640],[13206864,528525847],[769856237,960455863],[174362282,939558179],[959088861,981607405],[729138351,964738071],[551789588,630152806],[469697533,761665557],[399819681,913793735],[17984732,682765744],[325395543,812908184],[548754915,665335913],[574861379,782851164],[249430416,638743168],[314756196,404365724],[440295527,656457926],[569564900,726831856],[310326265,545722040],[237913871,736761771],[445865473,806591759],[700250714,819540110],[12555169,343574612],[36506548,928689077],[840492759,959986421],[887960064,951569903],[231232287,726638211],[123610663,957713227],[264015885,688033939],[749568149,841127642],[776552694,802902382],[842505597,928781301],[513894216,807359883],[620502107,887519724],[344470991,442744525],[238690924,811680880],[652997393,774576967],[913732972,919523383],[228361553,777024624],[146824152,546240263],[893463936,923026575],[866028737,971912086],[557807444,943802362],[880499052,996433587],[590326784,975823460],[590191637,903107097],[53337942,228766096],[491075951,946489952],[616927895,697988734],[787045468,987351517],[338028802,449988992],[569868519,954466769],[322606797,520166485],[608825565,727361754],[509853519,657937241],[799378584,879323279],[385029212,517724011],[807350383,914337302],[84087379,431530690],[591454517,805135953],[562190019,640805295],[740704838,910147531],[620161378,711594888],[974956384,991827730],[655255100,983010617],[703980798,928547030],[115281822,446686374],[644971263,666355427],[567006890,847884243],[577724780,578828257],[118767191,290749729],[508635266,517858737],[79948476,567450480],[959696466,960218289],[981628607,995234551],[297467586,425855282],[494680214,594932636],[545625854,768536037],[449449267,890462601],[703122555,796838379],[131260389,397819625],[650566438,694738986],[762341325,910670792],[425563863,925265737],[567215944,646074411],[264020739,782874825],[8616733,225545447],[860869084,912528799],[486808100,496048468],[745280955,967523009],[904733414,979809692],[180957166,899896731],[643087710,647192785],[21532119,23754318],[765302432,889107546],[714161007,924614119],[99065270,527765284],[946442268,977421374],[284577362,346695955],[320962489,511921806],[973434036,984167508],[262050226,342096766],[866305316,882240211],[989896804,995459408],[842319664,987476957],[958790188,966547667],[805014478,810981889],[393492549,726892781],[993534753,997060805],[69089374,467337232],[515789533,971126269],[165772004,521261140],[23017726,455387761],[97491603,581387900],[376067265,972827142],[348943499,856510499],[738234724,883310697],[964000342,983780695],[208403034,821164056],[604551089,871852881],[709271213,889007397],[352572731,485351143],[988408073,997946358],[621356570,836665945],[692787368,737150002],[478522734,812629081],[300005417,709806371],[521891470,534345476],[958990783,970221973],[707032900,758579660],[905954070,998927934],[308370083,374382147],[1411635,235455976],[579053726,758932123],[721103729,975477615],[955054235,956431959],[459903767,875591999],[355665302,896898420],[45126601,555347749],[439374350,773371453],[434783478,644477661],[563305932,631904162],[342262639,714778752],[804741671,956870601],[555846716,785760028],[524610711,956362510],[415511136,751818035],[667834536,880546953],[308813714,795284564],[357276016,364647260],[524238040,611135091],[697570527,810963940],[538374731,573951290],[525231233,693630349],[637498124,778176710],[347237589,425864540],[101485539,775540835],[403546037,877092607],[774784545,975986100],[9506771,714281784],[313385738,846693259],[25733855,319460858],[39474455,436636130],[631174751,839155393],[402758460,421316072],[373865997,742776861],[118775262,171348453],[511108534,919693576],[322993261,846057638],[855068169,921514612],[350843578,945415217],[897073880,988713005],[743689981,799964432],[848416248,889801374],[617838530,690946249],[380218218,683968277],[719959352,962893420],[679300028,717234943],[196568820,659892672],[228029944,276380870],[353310806,771160976],[249510576,889849667],[646190732,865919214],[316562437,737970185],[5088956,986924787],[599932030,875441679],[464883919,493695013],[921767095,923359736],[93049760,912118580],[324409067,802014330],[999979709,999983749],[760840649,784763010],[330097828,934798887],[455607274,529327947],[875385930,883437133],[461888402,934416053],[736131354,744816967],[965597629,999685544],[546359680,882743988],[743662603,997753533],[891003760,947425176],[816017984,928703876],[517301560,913687060],[874899798,900104820],[630164151,640440856],[572162157,738964378],[241335643,659263791],[575226569,742572713],[818048154,876584344],[74410,214068671],[294849966,780979741],[509126207,564363880],[519803209,593690104],[24901715,81451503],[787106620,926639970],[32082608,599473912],[932222501,982228079],[331168470,361865243],[512535968,703074055],[662103534,810931438],[168893973,688735811],[237014954,350334679],[857266674,944658064],[841714472,924816279],[437212216,445489658],[329475449,584550981],[487584556,931686361],[594183085,762166433],[361730182,439520456],[826148213,959826826],[419476307,695627384],[792736025,916305911],[789440071,928849591],[501958624,791794919],[532057503,743006781],[385008340,528693004],[278092190,481214620],[275457356,449852260],[542765850,579069058],[148079997,188398346],[602304684,889024909],[273657391,753325831],[975111049,992382502],[633096862,993376886],[981489115,989246198],[861111592,906050379],[640308645,700776710],[234219942,968387071],[659009539,785760395],[978438060,980077984],[198659459,658110716],[674968619,807018274],[150730350,151630032],[419161320,814602209],[194473946,569948761],[945181132,946946748],[185014082,363570113],[121678469,175518038],[974520666,981083193],[137303208,423277167],[816551810,915041369],[182155759,401988260],[488572983,684168317],[402124355,969932983],[557405759,948359667],[123354605,253090761],[71599639,874660121],[452693823,500856402],[557505054,581729963],[187896347,544581218],[143402736,690518677],[167193598,889881093],[487310061,984878418],[157260551,442948628],[613332237,699602552],[679912156,721389388],[12030441,303867266],[841209001,850060833],[234768321,590981063],[438843305,803162789],[87178868,131115572],[770691593,838416246],[937810473,945599537],[1401066,156300972],[674899634,881391530],[189130450,649189087],[705817518,812232207],[436632901,823969515],[33783356,281676160],[816541873,873798493],[126179159,739499406],[862252651,983699196],[468904763,756620710],[377375392,548517706],[254297528,800740941],[634109672,766509883],[849722508,994515431],[795096821,803043050],[156215702,674441199],[845552411,962678903],[968847241,983593785],[771503902,835171348],[121544619,847131683],[850790304,882652455],[363160258,465477358],[960997791,965116956],[692367075,906623643],[505219953,702736416],[392061005,890555113],[415978581,891564953],[717404819,913750656],[65466583,500833650],[452386060,851333995],[808662964,919753666],[680574310,683287971],[988738323,988888826],[511226373,921648040],[826934003,939145854],[417715012,831235304],[114936315,835398183],[444139387,569063593],[151881925,760265080],[445607512,498312795],[661717967,986439209],[879195828,930014422],[242207406,524566744],[445937461,756382032],[187349324,203616004],[637595509,812331415],[541061124,849857885],[158774632,319532245],[120576139,622629527],[686125706,724488929],[435363522,864383646],[727787376,905694579],[102147488,940257915],[49351720,93291697],[969517347,985865990],[770616206,921824846],[40284930,843849391],[707896479,980457257],[653137341,799952381],[28143476,738536481],[88485531,123356624],[921094620,928752872],[614794918,628834666],[691084076,962496123],[262581088,540502782],[365423080,601755838],[78585590,992736355],[168141250,375033254],[568896218,665904329],[967045484,973447450],[943560655,999484637],[824499837,932912773],[562052315,755729864],[923070240,943062731],[401978464,797305704],[176180064,719765103],[308863400,491265343],[523895336,994522467],[630273,293940829],[516536609,519306975],[926035598,935711976],[595936121,661816218],[706339096,792365643],[811170966,861643202],[48665799,465891687],[883388536,986275096],[425390794,526955657],[290258342,479600633],[867901979,964667238],[479029706,597153220],[989336756,994425422],[318826561,728274792],[102491294,142726641],[343021481,985093664],[436620626,982807606],[398131783,898921408],[777783965,823261768],[419579585,838721092],[455482827,830594851],[520635690,560256624],[506170518,974208434],[335946603,498542866],[326357418,373263366],[136661426,152769398],[903419297,937360045],[573032141,863817357],[961914045,968518138],[458825474,560349063],[404367147,571172461],[162267307,962976633],[678163963,965103574],[144681448,304384517],[113917239,392917623],[262194023,551051866],[637712259,882578155],[683879998,780225542],[725334188,748473800],[464300731,561548657],[755125942,781470174],[903841038,951490073],[619042756,972195826],[854331998,908821518],[775417773,869668073],[612869093,842672244],[744116569,792761629],[311945547,938537648],[265606430,777351921],[953273474,972303523],[849424778,930324235],[440248044,607532659],[570447604,587686305],[644150401,869007214],[73423579,142150112],[938536582,967909082],[932413629,943699045],[76273013,602109832],[715898694,889634158],[881660738,997136356],[676233920,886311708],[659053359,778869856],[477546286,644012621],[710408525,852335877],[323886222,359741772],[574303327,756195320],[340891190,652507726],[834580706,883093167],[718713345,862160594],[449980102,527210323],[925957002,937194015],[991657433,997387983],[897232601,902705242],[176946523,949847385],[779864308,920041702],[403251712,439088104],[725715034,994019110],[425123440,859016709],[491112787,834761451],[332101804,369403041],[902849473,959403129],[659363413,858997692],[389367864,519002431],[640852159,738594063],[217393248,349187280],[210646534,674308151],[231119352,243176225],[116056799,313604320],[682662304,787213610],[760300516,793439855],[593555216,951983322],[980744670,985281957],[657061482,882506349],[698967668,834850980],[180095880,383896577],[317112217,379121088],[982021468,987535271],[15015054,741774935],[283108414,882813290],[923606427,998442155],[685181320,688640876],[708967947,950613032],[954860932,975881805],[902494588,993673678],[998673811,999353587],[887406710,965374025],[886917424,905135819],[913391392,932969336],[35666942,573677066],[477847490,626565522],[414774901,649827908],[162256954,259451990],[121355329,857885314],[346747012,788332001],[305240624,378367493],[602971737,622890142],[374536290,750798341],[300799229,805280873],[806791906,924068354],[192488523,722609259],[724563948,774376324],[963145367,963547515],[348850532,933685936],[627304089,716674015],[934647206,995239209],[212057833,652594643],[642695759,979059435],[955063998,977869327],[691829201,882829916],[445243040,867767668],[13199139,410020583],[707381498,733532292],[255360799,639509027],[66881175,771167656],[943486628,947361724],[736764031,913688721],[694131903,897927729],[216365902,754364777],[221739997,828642238],[312020440,640729929],[407605821,747434179],[956965368,988863626],[976952849,986944668],[917078862,965530564],[280624845,558653636],[828188152,917577047],[197890354,667321011],[501688849,823758846],[51358362,337237023],[206094810,964496155],[59449389,67413181],[35198948,155013536],[136538656,353704324],[431259615,511974107],[588322240,750636388],[850083781,949757118],[854141523,948017001],[870741937,928700917],[527753637,941227525],[699791142,794367132],[960528865,989354415],[788120050,998273079],[974505597,974938666],[481274888,876806764],[161929730,595136157],[914917253,936706159],[103284643,260571870],[159726439,508163928],[721808785,813430151],[394488298,755224786],[337666682,782169090],[933453741,974214107],[828653260,898004875],[798172098,943098821],[314583674,776377743],[986651130,998215569],[389115029,913226223],[195480712,300358666],[32775969,887339623],[301960116,568959481],[47326293,892214075],[430449290,787126777],[436724960,994472839],[352720614,785300005],[365460518,817330639],[953512839,974979761],[412185410,974124702],[567683735,829064164],[971003204,996184474],[102170802,567462434],[231951901,810691977],[104384579,340662150],[583182118,916741171],[37653188,732257562],[366213586,995331729],[966918256,993469623],[566598332,695557309],[328389484,334152940],[954622073,997644785],[319514556,695565215],[677281706,739224278],[815005114,851737258],[183044012,772685516],[185982532,682731396],[77535117,748675847],[879055290,951892529],[17717535,327782633],[180546334,698353575],[148572161,897173945],[349455671,720530585],[166248570,858493703],[239880937,556736493],[950807932,962360848],[188283117,715472527],[164591503,302871068],[571942896,674423015],[546260600,636898384],[69002739,119057363],[438084597,944256201],[569565979,651018917],[9243924,385632030],[414620019,510915582],[971377763,974014536],[104640057,492658108],[988602996,997100100],[961050046,974315388],[269358606,603947653],[563970561,603847758],[111356849,590893597],[72797393,367415323],[334669572,532834825],[465060426,996645728],[295389802,523627841],[542209663,811369675],[623461123,936217385],[354742486,423566263],[114748702,273218841],[734249307,853776392],[455203767,731427376],[116410663,298834627],[169013269,439155507],[909534921,914314643],[62974176,658389929],[598031343,743410568],[262350049,309294687],[89415812,471751162],[931774327,965505390],[332516548,656834512],[245840711,877481166],[667072353,940960309],[301424764,682702659],[638803409,648986453],[231108253,670976364],[196286724,311248182],[63003250,146991224],[742725105,880874368],[900698442,955495441],[376054735,391831277],[392705138,620734875],[354351205,698757846],[544331423,672171598],[747733685,796461808],[908187314,924770644],[731247071,879743099],[757140655,804587673],[494614158,783563224],[45856242,321294346],[348077087,806637369],[199536167,791346041],[187802316,594218353],[473505916,484091087],[400691118,741947639],[856689051,919388463],[896693216,898527794],[826957612,975512077],[736728582,988686498],[610356124,910638291],[498553139,529470948],[326822667,607994301],[11713327,946807368],[350317595,830818805],[449351365,754181965],[145052600,557117430],[553874906,817665592],[532233334,951242442],[10942311,854334184],[840298702,891626810],[958152325,972484945],[489870410,917388156],[250163693,972319625],[268774937,906268278],[456574245,793882933],[344608423,777590854],[961220116,968988273],[901745103,969391478],[916434552,960530370],[918395830,942189611],[547571777,714134092],[984564679,986833618],[201607767,966468956],[807265097,893517319],[212200155,918796583],[308032844,591205249],[530021868,664557790],[27851319,469069423],[123748497,666928557],[636535076,875395015],[987329649,989338374],[383740366,845909535],[794757692,865249663],[332866037,907315719],[969756900,973934302],[617102154,754469712],[942734572,950243689],[893668902,954041359],[989460406,995785675],[976417482,997489523],[940905758,976851310],[987432985,990981040],[659959296,808564716],[679335615,846402129],[897485295,939067831],[652855186,737456656],[570569536,996670218],[369315554,875808640],[651554728,813347176],[242205875,946392997],[419620488,491536807],[990796633,993964000],[998415594,999838392],[904309939,967108833],[147709355,398811244],[35973567,795592599],[544478620,753729494],[513538611,513541721],[734478699,961986228],[759641322,850586751],[744447608,851259006],[69929122,724724267],[21828718,308124935],[2096463,280967894],[362834691,403965729],[645177550,808084594],[856375211,973300079],[205302725,726421601],[17311130,380492494],[192816071,384772421],[563745091,715342207],[908509430,914272589],[126692104,427109853],[976849886,983105972],[918595562,947973185],[122372102,926006434],[801590592,903121576],[95621582,361254646],[634147352,647478310],[166525419,374998586],[871717053,988903109],[378688803,473240514],[893356749,895686022],[610872750,886164641],[39791013,638036905],[361720133,416182873],[559528898,979185695],[937520621,980677385],[981796632,985711458],[306142608,513666308],[818287603,851250679],[42143141,992046115],[276156854,912654909],[788895762,911266716],[832072050,954034317],[233361746,627908212],[576119172,876694644],[387279841,615667992],[784831468,838568553],[409452457,810786951],[807689457,971356819],[846375,715859619],[588594800,695007957],[54818554,150579847],[140777561,143586221],[846788057,935196626],[149398077,183874438],[600346107,701244400],[632521047,999629345],[910797144,981034417],[820439339,921016808],[303093794,768973160],[366525838,450806472],[724717841,910495812],[249424103,343019588],[160511833,295868216],[817153232,886390124],[182718633,655588587],[697551643,709530560],[777856631,966380592],[582554091,989871157],[367820873,977704754],[867002854,923536046],[940820265,998973530],[319027431,999944389],[961893481,980695869],[896961200,916225262],[268055665,393504950],[49261948,568064665],[160154633,649323504],[127138955,467208504],[216868510,374010275],[650852805,749421187],[702948405,942045771],[291947084,294750064],[609928765,923009043],[796832741,860387056],[117904523,993101210],[455910204,717765138],[22652431,716326560],[750408437,812681271],[400844672,796462637],[283493213,821575680],[755940551,903105161],[625012817,661820977],[605984659,857875644],[823538804,927572696],[533833010,809188163],[964140535,977737131],[354725177,654740444],[902155417,996166301],[137009261,547256982],[304794011,859758745],[915583462,987888956],[485124115,793397107],[839832674,894344248],[1643642,539306319],[596684684,882814193],[876825586,944291091],[898489576,971482306],[393590317,693816179],[217665371,333957048],[981654352,995229185],[208065456,523076389],[370013562,610054482],[607565751,757320949],[433749593,692596602],[834788966,844891563],[549452453,869767141],[203588942,516814923],[528283962,647958071],[84312594,565135368],[435775634,606651964],[804180486,817510355],[208749183,986119866],[518930352,799031219],[188428348,272723349],[826563245,975706435],[773905824,851815753],[576358964,894060695],[591900334,884925273],[350541341,506657843],[382915742,497141176],[218603798,415262624],[643590621,977342923],[821968312,904941191],[516191791,517899387],[642864527,930567455],[575840357,982955695],[848777076,963390582],[918479640,983519111],[378370754,955833571],[287460760,966112783],[402829640,764258981],[488631184,768247169],[919403429,941940773],[136486411,288821393],[278153181,435257263],[520387375,763706290],[294431347,871890011],[959940494,990845572],[695066624,920174120],[646348612,670388071],[481333001,945585286],[318920973,615560295],[31247104,953086265],[850012812,916592856],[123127396,485793412],[48010730,147638150],[160314125,612717142],[217822907,528244648],[555173403,556058129],[339356430,892314510],[507784980,817195477],[465146353,645066204],[899760953,948209165],[86601124,134410121],[409800720,547341746],[784148415,790642735],[529062605,911053965],[545771789,769767369],[711811875,817812531],[145719414,607652439],[177255281,898850813],[788930121,890342950],[95049070,674749008],[896257010,979936072],[622942251,647748909],[477750122,552339423],[848602330,922069292],[70409281,138012553],[37428848,991061268],[170655320,176385398],[118254804,129748457],[496640637,645866798],[661267564,684807519],[819309528,923960385],[859441359,879892279],[566815957,838411635],[641905839,920742954],[409576393,929508489],[190384693,930470286],[327485262,467946969],[511278560,668167580],[796207254,869853368],[81478803,735795659],[189539456,951258722],[149951864,569893395],[382621854,597482429],[157513228,490606483],[136606057,275361919],[612330231,683058270],[797449571,920222360],[631567196,684926020],[645836628,785864759],[934129267,961869302],[644028653,707461463],[211125128,940539724],[144130517,824884259],[319100653,565222973],[17274502,941328821],[436168249,810984636],[624640427,985398519],[426770916,643718853],[301563124,746512215],[427873311,520401524],[834488096,960835767],[353304014,850473306],[260452535,376620596],[92441171,791957186],[543286369,843191189],[664701966,995673897],[936368368,990326131],[249942097,532207442],[865116179,979134273],[808843716,913869673],[589276550,955194488],[121388824,775582168],[628001841,631138383],[96928165,220094202],[378077232,930244740],[828065463,977265798],[15757382,457694291],[142751658,970818079],[459751138,867078751],[415677589,641227021],[713926502,768361152],[387797309,786496029],[437743786,797115855],[290131933,337767095],[830183492,937996224],[10778249,750069058],[311186201,914953853],[521549807,842211679],[173078363,403445423],[28607958,629694146],[834649411,940365558],[232695873,387870406],[388312378,663538476],[431439905,575078930],[999414704,999600788],[662887664,997548201],[111605689,620334485],[433751340,713255007],[731342002,853011218],[645916661,974931120],[440185264,948056258],[875235126,968735457],[622435612,791076599],[819230033,860077769],[802673390,851513539],[823551771,952607511],[898580480,921261889],[244017118,365254631],[4760815,55784486],[484991071,962359802],[340792416,652135796],[291302651,950499584],[560680884,739844562],[676682955,756157301],[311049462,630351126],[646244797,759833022],[298445700,828140270],[687063989,973387034],[142538373,619776971],[38633048,874507515],[516647214,649837414],[65843640,929640269],[502214481,922255266],[959563631,999144374],[23639408,577655289],[471607132,915929316],[874244341,876136931],[662458139,930828291],[96687766,208990267],[978101210,991375029],[7276265,35968043],[594019892,959769733],[673132545,957089036],[902278134,937653718],[893279672,947213991],[48531448,326378102],[28401389,426505532],[627330719,750614749],[810012866,871770996]] => 2272204859907; "case 2")]
    fn test_solution(queries: Vec<Vec<i32>>) -> i64 {
        Solution::min_operations(queries)
    }

    #[test_case(1,2 => 2)]
    #[test_case(2,4 => 4)]
    #[test_case(2,3 => 2)]
    #[test_case(1,4 => 5)]
    #[test_case(1,3 => 3)]
    #[test_case(3,10 => 15)]
    #[test_case(3,8 => 11)]
    fn test_counts(l: i32, r: i32) -> i64 {
        Solution::counts(l, r)
    }
}
